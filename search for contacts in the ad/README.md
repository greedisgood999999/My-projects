# Задача

Вам необходимо предсказать, есть ли в объявлении контактная информация.

Для обучения у вас есть следующие поля:
* `title` - заголовок,
* `description` - описание,
* `subcategory` - подкатегория,
* `category` - категория,
* `price` - цена,
* `region` - регион,
* `city` - город,
* `datetime_submitted` - дата размещения.

Таргет: `is_bad`

Есть два датасета `train.csv` и `val.csv`: `train.csv` содержит больше данных, однако разметка в нём менее точная; в `val.csv` существенно меньше данных, но более точная разметка.
Тестовый датасет, на котором мы оценим решнение, будет больше похож на `val.csv`.
При этом в датасетах могут встречаться (как и, к сожалению, в любых размечаемых данных) некорректные метки.

Данные находятся по ссылке https://drive.google.com/drive/folders/1anZ1bxi5WhPmBlCBnYBYzo4foSgGSee5?usp=sharing. 

Во время запуска вашего решения файл с тестовыми данными будет располагаться по пути `/task-for-hiring-data/test_data.csv`

Файл с результатом работы модели должен представлять из себя `csv` с колонками:
* `index`: `int`, положение записи в файле;
* `prediction`: `float` от 0 до 1, вероятность того, что в объявлении есть контактная информация.

|index  |prediction|
|-------|----------|
|0|0.12|
|1|0.95|
|...|...|
|N|0.68|

После отрабатывания скрипта `run.py` должен записаться csv-файл `/task-for-hiring-data/target_prediction.csv`.

В качестве метрики качества работы вашей модели мы будем использовать усредненный `ROC-AUC` по каждой категории объявлений.

Также есть задача "со звездочкой": предсказать начало и конец контактной информации в описании объявления. Например:
* для строки `Звоните на +7-888-888-88-88, в объявлении некорректный номер`: (11, 26),
* для строки `Звоните на +7-888aaaaa888aaaa88a88, в объявлении некорректный номер`: (11, 33),
* для строки `мой tg: @ivanicki_i на звонки не отвечаю`: (8, 18),
* для строки `мой tg: ivanicki_i на звонки не отвечаю`: (8, 17),
* если в описании объявления (поле `description`) контактов нет, то (None, None)
* если в описании объявления (поле `description`) более одного контакта (`Звоните не 89990000000 или на 89991111111`), то (None, None).

Файл с результатом работы модели должен представлять из себя `csv` с колонками:
* `index`: `int`, положение записи в файле;
* `start`: `int` or `None`, начало маски контакта;
* `end`: `int` or `None`, конец маски контакта.\
(`start` < `end`)

|index  |start|end|
|-------|----------|-----|
|0|None|None|
|1|0|23
|2|31|123
|...|...|
|N|None|None

После отрабатывания скрипта `run.py` должен записаться csv-файл `/task-for-hiring-data/mask_prediction.csv`.

Для задачи со звездочкой метрикой будет усредненный IoU (`Intersection over Union`) по текстам объявлений.

У контейнера не будет доступа в интернет.
Вы можете добавить нужные библиотеки в файл `requirements.txt` или напрямую в `Dockerfile`.

Сделайте форк этого репозитория, а в качестве решения пришлите ссылку на вашу ветку

Удачи :)

# Запуск решения
1. Docker-образ будет собираться командой:\
```docker build -t task_for_hiring -f Dockerfile .```
2. Далее контейнер будет запускаться:\
```docker run -it -v ~/main/task-for-hiring-data:/task-for-hiring-data task_for_hiring python lib/run.py```
3. Файлы с полученным предсказанием должны находиться по тому же пути, что и в тестовом варианте скрипта `lib/run.py`

Обратите внимание, что в контейнере по умолчанию используется python3:

```docker run -it task_for_hiring python -c "import sys; print(sys.version)"```
> 3.7.3 (default, Mar 27 2019, 22:11:17)

Ресурсы контейнера:
* 4 Гб оперативной памяти
* 2 ядра CPU
* нет GPU

Ограничение на время работы:
* 100 000 объектов должны обрабатываться не более 90 минут

# Baseline

Текущий бэйзлайн, который надо побить для первой части - 0.9.

